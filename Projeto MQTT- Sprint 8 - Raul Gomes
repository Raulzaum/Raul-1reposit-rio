#include <PubSubClient.h>
#include <UIPEthernet.h>
#include <SPI.h>

int pino2 = 2; ///variável definidda para o servidor
boolean mensagem;
boolean estado_sensor;

byte mac[] ={0xF0,0x8E,0x4A,0x06,0x02};
boolean mensagem;
EthernetClient client; /// apresenta um cliente Ethernet
PubSubClient mqttClient(client);
void setup() {
  Ethernet.begin(mac); /// Controlador Ethernet
  
  Serial.begin(9600);
  
  mqttClient.setServer("3.82.94.158",1883);

  Serial.print("O IP do Arduino e:"); /// Dentro do Monitor Serial, são manifestadas informações sobre o IP
  Serial.println(Ethernet.localIP());
 
  Serial.print(" A mascara de Rede do Arduino e:"); /// Dentro do Monitor Serial, são manifestadas informações sobre a máscara de Rede
  Serial.println(Ethernet.subnetMask());

  Serial.print("O Gateway do Arduino e:"); ///Dentro do Monitor Serial, são manifestadas informações sobre o Gateway
  Serial.println(Ethernet.gatewayIP());

}
void loop(){
  mqttClient.connect("raulgn");
  estado_sensor = digitalRead(pino2); ///"estado_sensor" passa a obter o valor do "digitalRead", onde a mesma pode variar entre 0 e 1

if(estado_sensor == 1){
     mensagem = mqttClient.publish("A porta está aberta!"); /// Só aparecerá esta mensagem caso a resposta do "digitalRead" for 1
     Serial.println(mensagem);
}
else{
     mensagem = mqttClient.publish("A porta está fechada!"); /// Só aparecerá esta mensagem caso a resposta do "digitalRead" for 1
     Serial.println(mensagem);
}

  MqttClient.loop();
}
